# Generated by Django 5.2.9 on 2026-01-02 00:11

from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Automation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('automation_name', models.CharField(help_text='Name of the automation', max_length=255)),
                ('automation_description', models.TextField(blank=True, help_text='Description of what this automation does')),
                ('automation_is_active', models.BooleanField(default=True, help_text='Whether this automation is currently active')),
                ('trigger_type', models.CharField(choices=[('event_based', 'Event Based'), ('time_based', 'Time Based'), ('condition_based', 'Condition Based'), ('manual', 'Manual Trigger'), ('webhook', 'Webhook Trigger'), ('api_call', 'API Call')], help_text='What triggers this automation', max_length=100)),
                ('trigger_config', models.JSONField(blank=True, default=dict, help_text='Configuration for the trigger')),
                ('priority', models.IntegerField(default=100, help_text='Priority of the automation (lower numbers execute first)')),
                ('max_executions_per_minute', models.IntegerField(default=60, help_text='Max number of times this can execute per minute')),
                ('execution_timeout_seconds', models.IntegerField(default=30, help_text='Timeout for execution in seconds')),
                ('error_handling', models.JSONField(blank=True, default=dict, help_text='How to handle errors during execution')),
                ('automation_created_at', models.DateTimeField(auto_now_add=True)),
                ('automation_updated_at', models.DateTimeField(auto_now=True)),
                ('last_executed', models.DateTimeField(blank=True, help_text='Last time this was executed', null=True)),
                ('execution_count', models.IntegerField(default=0, help_text='Number of times this has been executed')),
                ('failure_count', models.IntegerField(default=0, help_text='Number of times this has failed')),
                ('average_execution_time_ms', models.FloatField(default=0.0, help_text='Average execution time in milliseconds')),
                ('tags', models.JSONField(blank=True, default=list, help_text='Tags for organizing automations')),
                ('notes', models.TextField(blank=True, help_text='Internal notes about this automation')),
                ('is_system', models.BooleanField(default=False, help_text='Automation Triggered By System')),
            ],
            options={
                'verbose_name': 'Automation',
                'verbose_name_plural': 'Automations',
                'ordering': ['priority', '-automation_created_at'],
            },
        ),
        migrations.CreateModel(
            name='AutomationAction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action_type', models.CharField(choices=[('send_email', 'Send Email'), ('create_task', 'Create Task'), ('update_field', 'Update Field'), ('run_function', 'Run Function'), ('create_case', 'Create Case'), ('assign_owner', 'Assign Owner'), ('send_slack_message', 'Send Slack Message'), ('webhook', 'Webhook Call'), ('custom', 'Custom Action'), ('send_sms', 'Send SMS'), ('send_teams_message', 'Send Microsoft Teams Message'), ('send_whatsapp', 'Send WhatsApp Message')], help_text='Type of action to perform', max_length=50)),
                ('automation_action_name', models.CharField(help_text='Name of this action', max_length=255)),
                ('automation_action_description', models.TextField(blank=True, help_text='Description of what this action does')),
                ('config', models.JSONField(blank=True, default=dict, help_text='Configuration parameters for the action')),
                ('automation_action_is_active', models.BooleanField(default=True, help_text='Whether this action is active')),
                ('order', models.IntegerField(default=0, help_text='Order to execute actions (lower numbers first)')),
                ('automation_action_created_at', models.DateTimeField(auto_now_add=True)),
                ('automation_action_updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Automation Action',
                'verbose_name_plural': 'Automation Actions',
                'ordering': ['automation', 'order'],
            },
        ),
        migrations.CreateModel(
            name='AutomationAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('alert_title', models.CharField(max_length=255)),
                ('alert_message', models.TextField()),
                ('alert_severity', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], default='medium', max_length=20)),
                ('alert_status', models.CharField(choices=[('active', 'Active'), ('acknowledged', 'Acknowledged'), ('resolved', 'Resolved'), ('dismissed', 'Dismissed')], default='active', max_length=20)),
                ('alert_acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('alert_created_at', models.DateTimeField(auto_now_add=True)),
                ('alert_updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'abstract': False,
            },
        ),
        migrations.CreateModel(
            name='AutomationCondition',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('field_path', models.CharField(help_text="Dot notation path to the field to check (e.g., 'user.profile.status')", max_length=255)),
                ('operator', models.CharField(choices=[('eq', 'Equals'), ('ne', 'Not Equal'), ('gt', 'Greater Than'), ('lt', 'Less Than'), ('gte', 'Greater Than or Equal'), ('lte', 'Less Than or Equal'), ('in', 'In List'), ('contains', 'Contains'), ('regex', 'Matches Regex')], help_text='Comparison operator to use', max_length=10)),
                ('value', models.TextField(help_text='Expected value for comparison')),
                ('automation_condition_is_active', models.BooleanField(default=True, help_text='Whether this condition is active')),
                ('order', models.IntegerField(default=0, help_text='Order to evaluate conditions (lower numbers first)')),
                ('automation_condition_created_at', models.DateTimeField(auto_now_add=True)),
                ('automation_condition_updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Automation Condition',
                'verbose_name_plural': 'Automation Conditions',
                'ordering': ['automation', 'order'],
            },
        ),
        migrations.CreateModel(
            name='AutomationExecutionLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('conditions_evaluated', 'Conditions Evaluated'), ('executing', 'Executing'), ('completed', 'Completed'), ('failed', 'Failed'), ('skipped', 'Skipped')], default='pending', max_length=20)),
                ('trigger_payload', models.JSONField(help_text='Payload that triggered the automation')),
                ('execution_time_ms', models.IntegerField(blank=True, help_text='Time taken to execute in milliseconds', null=True)),
                ('error_message', models.TextField(blank=True, help_text='Error message if execution failed')),
                ('completed_at', models.DateTimeField(blank=True, help_text='When execution was completed', null=True)),
                ('automation_execution_log_created_at', models.DateTimeField(auto_now_add=True)),
                ('automation_execution_log_updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Automation Execution Log',
                'verbose_name_plural': 'Automation Execution Logs',
                'ordering': ['-automation_execution_log_created_at'],
            },
        ),
        migrations.CreateModel(
            name='AutomationNotificationPreference',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('notify_on_all_failures', models.BooleanField(default=False)),
                ('notify_on_critical_only', models.BooleanField(default=True)),
                ('enable_email_notifications', models.BooleanField(default=True)),
                ('enable_sms_notifications', models.BooleanField(default=False)),
                ('enable_in_app_notifications', models.BooleanField(default=True)),
                ('notification_frequency', models.CharField(choices=[('immediate', 'Immediate'), ('daily_digest', 'Daily Digest'), ('weekly_summary', 'Weekly Summary')], default='immediate', max_length=20)),
                ('alert_created_at', models.DateTimeField(auto_now_add=True)),
                ('alert_updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Automation Notification Preference',
                'verbose_name_plural': 'Automation Notification Preferences',
            },
        ),
        migrations.CreateModel(
            name='AutomationRule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('automation_rule_name', models.CharField(help_text='Name of the automation rule', max_length=255)),
                ('automation_rule_description', models.TextField(blank=True, help_text='Description of what this rule does')),
                ('automation_rule_is_active', models.BooleanField(default=True, help_text='Whether this rule is currently active')),
                ('trigger_type', models.CharField(choices=[('event_based', 'Event Based'), ('time_based', 'Time Based'), ('condition_based', 'Condition Based'), ('manual', 'Manual Trigger'), ('webhook', 'Webhook Trigger'), ('api_call', 'API Call')], max_length=100)),
                ('trigger_config', models.JSONField(blank=True, default=dict, help_text='Configuration for the trigger')),
                ('conditions', models.JSONField(blank=True, default=list, help_text='Conditions that must be met for the rule to execute')),
                ('actions', models.JSONField(blank=True, default=list, help_text='Actions to perform when the rule executes')),
                ('priority', models.IntegerField(default=100, help_text='Priority of the rule (lower numbers execute first)')),
                ('max_executions_per_minute', models.IntegerField(default=60, help_text='Max number of times this rule can execute per minute')),
                ('execution_timeout_seconds', models.IntegerField(default=30, help_text='Timeout for rule execution in seconds')),
                ('error_handling', models.JSONField(blank=True, default=dict, help_text='How to handle errors during execution')),
                ('automation_rule_created_at', models.DateTimeField(auto_now_add=True)),
                ('automation_rule_updated_at', models.DateTimeField(auto_now=True)),
                ('last_executed', models.DateTimeField(blank=True, help_text='Last time this rule was executed', null=True)),
                ('execution_count', models.IntegerField(default=0, help_text='Number of times this rule has been executed')),
                ('failure_count', models.IntegerField(default=0, help_text='Number of times this rule has failed')),
                ('average_execution_time_ms', models.FloatField(default=0.0, help_text='Average execution time in milliseconds')),
                ('tags', models.JSONField(blank=True, default=list, help_text='Tags for organizing automation rules')),
                ('notes', models.TextField(blank=True, help_text='Internal notes about this rule')),
            ],
            options={
                'verbose_name': 'Automation Rule',
                'verbose_name_plural': 'Automation Rules',
                'ordering': ['priority', '-automation_rule_created_at'],
            },
        ),
        migrations.CreateModel(
            name='CustomCodeExecutionLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('execution_status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed'), ('timeout', 'Timeout'), ('security_violation', 'Security Violation')], default='pending', max_length=20)),
                ('input_parameters', models.JSONField(blank=True, default=dict, help_text='Input parameters passed to the code')),
                ('output_result', models.JSONField(blank=True, default=dict, help_text='Output result from the code execution')),
                ('error_message', models.TextField(blank=True, help_text='Error message if execution failed')),
                ('execution_time_ms', models.IntegerField(blank=True, help_text='Time taken to execute in milliseconds', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Custom Code Execution Log',
                'verbose_name_plural': 'Custom Code Execution Logs',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='CustomCodeSnippet',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Name of the custom code snippet', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Description of what this code does')),
                ('code_content', models.TextField(help_text='The actual Python code to execute')),
                ('language', models.CharField(choices=[('python', 'Python')], default='python', max_length=50)),
                ('parameters_schema', models.JSONField(blank=True, default=dict, help_text='JSON schema for expected parameters')),
                ('is_active', models.BooleanField(default=True, help_text='Whether this code snippet is active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Custom Code Snippet',
                'verbose_name_plural': 'Custom Code Snippets',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='QualityCheckSchedule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quality_check_schedule_name', models.CharField(help_text='Name of the quality check schedule', max_length=255)),
                ('quality_check_schedule_description', models.TextField(blank=True, help_text='Description of what the quality check validates')),
                ('quality_check_schedule_is_active', models.BooleanField(default=True, help_text='Whether this schedule is currently active')),
                ('quality_check_schedule_check_type', models.CharField(choices=[('data_completeness', 'Data Completeness'), ('data_accuracy', 'Data Accuracy'), ('data_consistency', 'Data Consistency'), ('data_uniqueness', 'Data Uniqueness'), ('data_timeliness', 'Data Timeliness'), ('data_validity', 'Data Validity'), ('data_integrity', 'Data Integrity'), ('duplicate_detection', 'Duplicate Detection'), ('schema_validation', 'Schema Validation'), ('referential_integrity', 'Referential Integrity')], max_length=100)),
                ('quality_check_schedule_target_resource', models.CharField(help_text='Resource to check (e.g., table name, API endpoint)', max_length=255)),
                ('quality_check_schedule_check_config', models.JSONField(blank=True, default=dict, help_text='Configuration for the quality check')),
                ('quality_check_schedule_schedule_type', models.CharField(choices=[('once', 'Once'), ('hourly', 'Hourly'), ('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly'), ('custom', 'Custom')], default='daily', max_length=50)),
                ('quality_check_schedule_schedule_config', models.JSONField(blank=True, default=dict, help_text='Configuration for the schedule')),
                ('quality_check_schedule_next_run', models.DateTimeField(help_text='When the next check is scheduled to run')),
                ('quality_check_schedule_last_run', models.DateTimeField(blank=True, help_text='When the check was last run', null=True)),
                ('quality_check_schedule_last_run_status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('quality_check_schedule_last_run_result', models.JSONField(blank=True, default=dict, help_text='Result of the last run')),
                ('quality_check_schedule_pass_threshold_percent', models.FloatField(default=95.0, help_text='Percentage of data that must pass to consider the check passed')),
                ('quality_check_schedule_fail_on_error', models.BooleanField(default=True, help_text='Whether to fail the check if any errors occur')),
                ('quality_check_schedule_notification_emails', models.JSONField(blank=True, default=list, help_text='Email addresses to notify on failure')),
                ('quality_check_schedule_created_at', models.DateTimeField(auto_now_add=True)),
                ('quality_check_schedule_updated_at', models.DateTimeField(auto_now=True)),
                ('quality_check_schedule_last_pass', models.DateTimeField(blank=True, help_text='Last time the check passed', null=True)),
                ('quality_check_schedule_last_fail', models.DateTimeField(blank=True, help_text='Last time the check failed', null=True)),
                ('quality_check_schedule_failure_count', models.IntegerField(default=0, help_text='Number of consecutive failures')),
                ('quality_check_schedule_success_count', models.IntegerField(default=0, help_text='Number of successful runs')),
                ('quality_check_schedule_tags', models.JSONField(blank=True, default=list, help_text='Tags for organizing quality check schedules')),
                ('quality_check_schedule_notes', models.TextField(blank=True, help_text='Internal notes about this quality check schedule')),
            ],
            options={
                'verbose_name': 'Quality Check Schedule',
                'verbose_name_plural': 'Quality Check Schedules',
                'ordering': ['quality_check_schedule_name'],
            },
        ),
        migrations.CreateModel(
            name='WebhookDeliveryLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_type', models.CharField(help_text='Type of event that triggered the webhook', max_length=100)),
                ('payload', models.TextField(help_text='The payload sent to the webhook')),
                ('headers', models.JSONField(blank=True, default=dict, help_text='Headers sent with the request')),
                ('webhook_delivery_url', models.URLField(help_text='URL the webhook was sent to', max_length=500)),
                ('http_method', models.CharField(help_text='HTTP method used', max_length=10)),
                ('status', models.CharField(choices=[('sent', 'Sent'), ('delivered', 'Delivered'), ('failed', 'Failed'), ('retrying', 'Retrying'), ('timeout', 'Timeout'), ('rate_limited', 'Rate Limited')], default='sent', max_length=20)),
                ('response_status_code', models.IntegerField(blank=True, help_text='HTTP status code of the response', null=True)),
                ('response_headers', models.JSONField(blank=True, default=dict, help_text='Headers received in the response')),
                ('response_body', models.TextField(blank=True, help_text='Body of the response')),
                ('execution_time_ms', models.FloatField(blank=True, help_text='Time taken to execute the request in milliseconds', null=True)),
                ('error_message', models.TextField(blank=True, help_text='Error message if the request failed')),
                ('retry_count', models.IntegerField(default=0, help_text='Number of retries attempted')),
                ('webhook_delivery_created_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, help_text='When the delivery was completed (success or failure)', null=True)),
                ('signature', models.CharField(blank=True, help_text='Signature that was sent with the webhook', max_length=255)),
                ('tags', models.JSONField(blank=True, default=list, help_text='Tags for organizing delivery logs')),
                ('notes', models.TextField(blank=True, help_text='Internal notes about this delivery')),
            ],
            options={
                'verbose_name': 'Webhook Delivery Log',
                'verbose_name_plural': 'Webhook Delivery Logs',
                'ordering': ['-webhook_delivery_created_at'],
            },
        ),
        migrations.CreateModel(
            name='WebhookEndpoint',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('webhook_endpoint_name', models.CharField(help_text='Name of the webhook endpoint', max_length=255)),
                ('webhook_endpoint_description', models.TextField(blank=True, help_text='Description of what this webhook does')),
                ('webhook_endpoint_url', models.URLField(help_text='The URL to send webhook payloads to', max_length=500)),
                ('webhook_endpoint_is_active', models.BooleanField(default=True, help_text='Whether this webhook is currently active')),
                ('event_types', models.JSONField(blank=True, default=list, help_text='Types of events that trigger this webhook')),
                ('http_method', models.CharField(choices=[('GET', 'GET'), ('POST', 'POST'), ('PUT', 'PUT'), ('PATCH', 'PATCH'), ('DELETE', 'DELETE')], default='POST', max_length=10)),
                ('headers', models.JSONField(blank=True, default=dict, help_text='Headers to send with the webhook request')),
                ('secret', models.CharField(blank=True, help_text='Secret used to sign webhook payloads', max_length=255)),
                ('signature_header', models.CharField(default='X-Signature', help_text='Header name for the signature', max_length=50)),
                ('signature_algorithm', models.CharField(default='sha256', help_text='Algorithm used for signatures', max_length=20)),
                ('timeout_seconds', models.IntegerField(default=30, help_text='Timeout for webhook requests in seconds')),
                ('retry_attempts', models.IntegerField(default=3, help_text='Number of retry attempts on failure')),
                ('retry_delay_seconds', models.IntegerField(default=5, help_text='Delay between retries in seconds')),
                ('rate_limit', models.IntegerField(default=100, help_text='Max requests per time period')),
                ('rate_limit_period_seconds', models.IntegerField(default=3600, help_text='Time period for rate limiting in seconds')),
                ('webhook_endpoint_created_at', models.DateTimeField(auto_now_add=True)),
                ('webhook_endpoint_updated_at', models.DateTimeField(auto_now=True)),
                ('last_called', models.DateTimeField(blank=True, help_text='Last time this webhook was called', null=True)),
                ('last_response_code', models.IntegerField(blank=True, help_text='Last HTTP response code received', null=True)),
                ('last_error', models.TextField(blank=True, help_text='Last error message if any')),
                ('failure_count', models.IntegerField(default=0, help_text='Number of consecutive failures')),
                ('disabled_after_failures', models.IntegerField(default=5, help_text='Disable after this many failures')),
                ('tags', models.JSONField(blank=True, default=list, help_text='Tags for organizing webhooks')),
                ('notes', models.TextField(blank=True, help_text='Internal notes about this webhook')),
            ],
            options={
                'verbose_name': 'Webhook Endpoint',
                'verbose_name_plural': 'Webhook Endpoints',
                'ordering': ['-webhook_endpoint_created_at'],
            },
        ),
        migrations.CreateModel(
            name='Workflow',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('workflow_name', models.CharField(help_text='Name of the workflow', max_length=255)),
                ('workflow_description', models.TextField(blank=True, help_text='Description of what this workflow does')),
                ('workflow_trigger_type', models.CharField(choices=[('account.created', 'Account Created'), ('account.health_changed', 'Account Health Changed'), ('lead.created', 'Lead Created'), ('lead.qualified', 'Lead Qualified'), ('opportunity.created', 'Opportunity Created'), ('opportunity.stage_changed', 'Opportunity Stage Changed'), ('proposal.viewed', 'Proposal Viewed'), ('proposal.esg_viewed', 'ESG Section Viewed'), ('case.created', 'Case Created'), ('case.sla_breached', 'SLA Breached'), ('case.csat_submitted', 'CSAT Submitted'), ('nps.submitted', 'NPS Submitted'), ('nps.detractor_alert', 'NPS Detractor Alert'), ('custom_status.changed', 'Custom Status Changed'), ('crm_setting.changed', 'CRM Setting Changed'), ('team.member_onboarded', 'Team Member Onboarded'), ('web_to_lead.submitted', 'Web-to-Lead Submitted')], help_text='What triggers this workflow', max_length=50)),
                ('workflow_is_active', models.BooleanField(default=True, help_text='Whether this workflow is currently active')),
                ('workflow_created_at', models.DateTimeField(auto_now_add=True)),
                ('workflow_updated_at', models.DateTimeField(auto_now=True)),
                ('workflow_builder_data', models.JSONField(blank=True, default=dict, help_text='Raw data from visual builder')),
            ],
            options={
                'verbose_name': 'Workflow',
                'verbose_name_plural': 'Workflows',
                'ordering': ['-workflow_created_at'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowAction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('workflow_action_type', models.CharField(choices=[('send_email', 'Send Email'), ('create_task', 'Create Task'), ('update_field', 'Update Field'), ('run_function', 'Run Function'), ('create_case', 'Create Case'), ('assign_owner', 'Assign Owner'), ('send_slack_message', 'Send Slack Message'), ('webhook', 'Webhook'), ('create_nba', 'Create Next Best Action'), ('send_sms', 'Send SMS'), ('send_teams_message', 'Send Microsoft Teams Message'), ('send_whatsapp', 'Send WhatsApp Message'), ('approval', 'Request Approval'), ('delay', 'Delay Execution'), ('loop', 'Loop/Iterate'), ('custom_code', 'Custom Code Action')], help_text='Type of action to perform', max_length=50)),
                ('workflow_action_parameters', models.JSONField(default=dict, help_text='Parameters for the action (JSON)')),
                ('workflow_action_order', models.IntegerField(default=0, help_text='Execution order (lower executes first)')),
                ('workflow_action_is_active', models.BooleanField(default=True, help_text='Whether this action is active')),
                ('workflow_action_created_at', models.DateTimeField(auto_now_add=True)),
                ('workflow_action_updated_at', models.DateTimeField(auto_now=True)),
                ('branch_value', models.BooleanField(blank=True, help_text="True if action is in the 'Yes' path, False if in 'No' path", null=True)),
            ],
            options={
                'verbose_name': 'Workflow Action',
                'verbose_name_plural': 'Workflow Actions',
                'ordering': ['workflow_action_order', 'workflow_action_created_at'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowAnalyticsSnapshot',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('snapshot_date', models.DateField(help_text='Date this snapshot covers')),
                ('total_executions', models.IntegerField(default=0)),
                ('successful_executions', models.IntegerField(default=0)),
                ('failed_executions', models.IntegerField(default=0)),
                ('avg_execution_time_ms', models.FloatField(default=0.0)),
                ('min_execution_time_ms', models.IntegerField(default=0)),
                ('max_execution_time_ms', models.IntegerField(default=0)),
                ('action_stats', models.JSONField(blank=True, default=dict, help_text='Stats per action type')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Workflow Analytics Snapshot',
                'verbose_name_plural': 'Workflow Analytics Snapshots',
                'ordering': ['-snapshot_date'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowApproval',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('approval_status', models.CharField(choices=[('pending', 'Pending'), ('approved', 'Approved'), ('rejected', 'Rejected'), ('expired', 'Expired')], default='pending', max_length=20)),
                ('approval_comments', models.TextField(blank=True)),
                ('approval_responded_at', models.DateTimeField(blank=True, null=True)),
                ('approval_created_at', models.DateTimeField(auto_now_add=True)),
                ('approval_updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Workflow Approval',
                'verbose_name_plural': 'Workflow Approvals',
                'ordering': ['-approval_created_at'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowBranch',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('branch_name', models.CharField(help_text='Name of this branching point', max_length=255)),
                ('branch_conditions', models.JSONField(default=dict, help_text='Conditions to evaluate for branching (JSON)')),
                ('branch_order', models.IntegerField(default=0, help_text='Order in which this branch occurs')),
                ('branch_is_active', models.BooleanField(default=True)),
                ('branch_created_at', models.DateTimeField(auto_now_add=True)),
                ('branch_updated_at', models.DateTimeField(auto_now=True)),
                ('parent_branch_value', models.BooleanField(blank=True, help_text="True if this branch is in the 'Yes' path of parent", null=True)),
            ],
            options={
                'verbose_name': 'Workflow Branch',
                'verbose_name_plural': 'Workflow Branches',
                'ordering': ['branch_order', 'branch_created_at'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowExecution',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('workflow_execution_trigger_payload', models.JSONField(help_text='Data that triggered the workflow')),
                ('workflow_execution_status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled'), ('waiting_for_approval', 'Waiting for Approval')], default='pending', max_length=20)),
                ('workflow_execution_error_message', models.TextField(blank=True)),
                ('workflow_execution_executed_at', models.DateTimeField(auto_now_add=True)),
                ('workflow_execution_completed_at', models.DateTimeField(blank=True, null=True)),
                ('workflow_execution_execution_time_ms', models.IntegerField(blank=True, help_text='Execution time in milliseconds', null=True)),
                ('workflow_execution_current_step_id', models.IntegerField(blank=True, help_text='ID of the next action to execute', null=True)),
                ('workflow_execution_current_branch_id', models.IntegerField(blank=True, help_text='ID of the current branch', null=True)),
                ('workflow_execution_current_branch_value', models.BooleanField(blank=True, null=True)),
                ('workflow_execution_context_data', models.JSONField(blank=True, default=dict, help_text='Saved context for resuming execution')),
                ('is_replay', models.BooleanField(default=False, help_text='Whether this is a replay of a previous execution')),
                ('workflow_execution_created_at', models.DateTimeField(auto_now_add=True)),
                ('workflow_execution_updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Workflow Execution',
                'verbose_name_plural': 'Workflow Executions',
                'ordering': ['-workflow_execution_executed_at'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowScheduledExecution',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('scheduled_for', models.DateTimeField(help_text='When this action should be executed')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('executed', 'Executed'), ('cancelled', 'Cancelled'), ('failed', 'Failed')], default='pending', max_length=20)),
                ('context_data', models.JSONField(blank=True, default=dict, help_text='Saved context for execution')),
                ('executed_at', models.DateTimeField(blank=True, null=True)),
                ('error_message', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Workflow Scheduled Execution',
                'verbose_name_plural': 'Workflow Scheduled Executions',
                'ordering': ['scheduled_for'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('workflow_template_name', models.CharField(help_text='Name of the workflow template', max_length=255)),
                ('workflow_template_description', models.TextField(blank=True, help_text='Description of what this template does')),
                ('workflow_template_trigger_type', models.CharField(choices=[('account.created', 'Account Created'), ('account.health_changed', 'Account Health Changed'), ('lead.created', 'Lead Created'), ('lead.qualified', 'Lead Qualified'), ('opportunity.created', 'Opportunity Created'), ('opportunity.stage_changed', 'Opportunity Stage Changed'), ('proposal.viewed', 'Proposal Viewed'), ('proposal.esg_viewed', 'ESG Section Viewed'), ('case.created', 'Case Created'), ('case.sla_breached', 'SLA Breached'), ('case.csat_submitted', 'CSAT Submitted'), ('nps.submitted', 'NPS Submitted'), ('nps.detractor_alert', 'NPS Detractor Alert'), ('custom_status.changed', 'Custom Status Changed'), ('crm_setting.changed', 'CRM Setting Changed'), ('team.member_onboarded', 'Team Member Onboarded'), ('web_to_lead.submitted', 'Web-to-Lead Submitted')], max_length=50)),
                ('workflow_template_builder_data', models.JSONField(help_text='Drawflow JSON structure')),
                ('workflow_template_is_active', models.BooleanField(default=True, help_text='Whether this template is active')),
                ('workflow_template_created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Workflow Template',
                'verbose_name_plural': 'Workflow Templates',
                'ordering': ['workflow_template_name'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowTrigger',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('workflow_trigger_event', models.CharField(help_text='Event that triggers this workflow', max_length=100)),
                ('workflow_trigger_conditions', models.JSONField(default=dict, help_text='Conditions that must be met for the trigger to fire (JSON)')),
                ('workflow_trigger_is_active', models.BooleanField(default=True, help_text='Whether this trigger is active')),
                ('workflow_trigger_created_at', models.DateTimeField(auto_now_add=True)),
                ('workflow_trigger_updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Workflow Trigger',
                'verbose_name_plural': 'Workflow Triggers',
                'ordering': ['workflow_trigger_created_at'],
            },
        ),
        migrations.CreateModel(
            name='WorkflowVersion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('version_number', models.IntegerField(help_text='Sequential version number')),
                ('workflow_data_snapshot', models.JSONField(help_text='Full workflow configuration at this version')),
                ('change_summary', models.TextField(blank=True, help_text='Description of changes in this version')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Workflow Version',
                'verbose_name_plural': 'Workflow Versions',
                'ordering': ['-version_number'],
            },
        ),
    ]
