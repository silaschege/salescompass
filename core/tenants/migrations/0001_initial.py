# Generated by Django 5.2.7 on 2025-12-10 14:15

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('billing', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AutomatedTenantLifecycleRule',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Name of the lifecycle rule', max_length=255, unique=True)),
                ('description', models.TextField(blank=True, help_text='Description of the lifecycle rule')),
                ('is_active', models.BooleanField(default=True, help_text='Whether this rule is active')),
                ('condition_type', models.CharField(choices=[('usage_based', 'Usage Based'), ('time_based', 'Time Based'), ('billing_based', 'Billing Based'), ('activity_based', 'Activity Based'), ('custom', 'Custom Logic')], max_length=50)),
                ('condition_field', models.CharField(help_text='Field to check for the condition', max_length=100)),
                ('condition_operator', models.CharField(choices=[('equals', 'Equals'), ('not_equals', 'Not Equals'), ('greater_than', 'Greater Than'), ('less_than', 'Less Than'), ('greater_equal', 'Greater Than or Equal'), ('less_equal', 'Less Than or Equal'), ('contains', 'Contains'), ('not_contains', 'Not Contains')], max_length=20)),
                ('condition_value', models.CharField(help_text='Value to compare against', max_length=255)),
                ('action_type', models.CharField(choices=[('suspend', 'Suspend Tenant'), ('terminate', 'Terminate Tenant'), ('archive', 'Archive Tenant'), ('reactivate', 'Reactivate Tenant'), ('send_notification', 'Send Notification'), ('update_plan', 'Update Plan'), ('custom', 'Custom Action')], max_length=50)),
                ('action_parameters', models.JSONField(blank=True, default=dict, help_text='Parameters for the action')),
                ('evaluation_frequency', models.CharField(choices=[('hourly', 'Hourly'), ('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly')], default='daily', max_length=20)),
                ('last_evaluated', models.DateTimeField(blank=True, help_text='When the rule was last evaluated', null=True)),
                ('next_evaluation', models.DateTimeField(default=django.utils.timezone.now, help_text='When to next evaluate the rule')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='lifecycle_rules_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Automated Tenant Lifecycle Rule',
                'verbose_name_plural': 'Automated Tenant Lifecycle Rules',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='Tenant',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=255, unique=True)),
                ('slug', models.SlugField(help_text='URL-friendly identifier for the tenant', max_length=255, unique=True)),
                ('description', models.TextField(blank=True)),
                ('domain', models.CharField(blank=True, help_text='Custom domain for the tenant', max_length=255, null=True, unique=True)),
                ('subdomain', models.SlugField(blank=True, help_text='Subdomain for the tenant', max_length=255, null=True, unique=True)),
                ('logo_url', models.URLField(blank=True, help_text="URL to the tenant's logo")),
                ('primary_color', models.CharField(default='#6f42c1', help_text='Primary brand color in hex format', max_length=7, validators=[django.core.validators.RegexValidator(message='Enter a valid hex color code', regex='^#[0-9A-Fa-f]{6}$')])),
                ('secondary_color', models.CharField(default='#007bff', help_text='Secondary brand color in hex format', max_length=7, validators=[django.core.validators.RegexValidator(message='Enter a valid hex color code', regex='^#[0-9A-Fa-f]{6}$')])),
                ('subscription_status', models.CharField(choices=[('trialing', 'Trialing'), ('active', 'Active'), ('past_due', 'Past Due'), ('canceled', 'Canceled'), ('unpaid', 'Unpaid'), ('incomplete', 'Incomplete'), ('incomplete_expired', 'Incomplete Expired')], default='trialing', max_length=20)),
                ('trial_end_date', models.DateTimeField(blank=True, help_text='End date of trial period', null=True)),
                ('billing_cycle_anchor', models.DateTimeField(blank=True, help_text='Date for billing cycle alignment', null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('is_suspended', models.BooleanField(default=False)),
                ('suspension_reason', models.TextField(blank=True, help_text='Reason for suspension')),
                ('is_archived', models.BooleanField(default=False)),
                ('archived_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user_limit', models.IntegerField(default=10, help_text='Maximum number of users allowed')),
                ('storage_limit_mb', models.IntegerField(default=1000, help_text='Storage limit in MB')),
                ('api_call_limit', models.IntegerField(default=10000, help_text='Monthly API call limit')),
                ('tenant_config', models.JSONField(blank=True, default=dict, help_text='Tenant-specific configuration')),
                ('plan', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tenants', to='billing.plan')),
            ],
            options={
                'verbose_name': 'Tenant',
                'verbose_name_plural': 'Tenants',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='AutomatedTenantLifecycleEvent',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('event_type', models.CharField(choices=[('rule_evaluated', 'Rule Evaluated'), ('action_taken', 'Action Taken'), ('action_skipped', 'Action Skipped'), ('error_occurred', 'Error Occurred')], max_length=50)),
                ('status', models.CharField(choices=[('success', 'Success'), ('failed', 'Failed'), ('skipped', 'Skipped')], max_length=20)),
                ('details', models.TextField(blank=True, help_text='Details about the event')),
                ('triggered_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('executed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='automated_lifecycle_events_executed', to=settings.AUTH_USER_MODEL)),
                ('rule', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='events', to='tenants.automatedtenantlifecyclerule')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='automated_lifecycle_events', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Automated Tenant Lifecycle Event',
                'verbose_name_plural': 'Automated Tenant Lifecycle Events',
                'ordering': ['-triggered_at'],
            },
        ),
        migrations.CreateModel(
            name='TenantCloneHistory',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('clone_type', models.CharField(choices=[('full_copy', 'Full Copy'), ('template_based', 'Template Based'), ('minimal_setup', 'Minimal Setup'), ('data_migration', 'Data Migration')], max_length=50)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('clone_options', models.JSONField(blank=True, default=dict, help_text='Options for the cloning process')),
                ('progress_percentage', models.FloatField(default=0.0)),
                ('total_steps', models.IntegerField(default=0)),
                ('completed_steps', models.IntegerField(default=0)),
                ('error_message', models.TextField(blank=True)),
                ('success_message', models.TextField(blank=True)),
                ('cloned_tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='cloned_from', to='tenants.tenant')),
                ('completed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tenant_clones_completed', to=settings.AUTH_USER_MODEL)),
                ('initiated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tenant_clones_initiated', to=settings.AUTH_USER_MODEL)),
                ('original_tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='clones_created', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Tenant Clone History',
                'verbose_name_plural': 'Tenant Clone Histories',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='TenantDataPreservation',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('preservation_type', models.CharField(choices=[('full_backup', 'Full Backup'), ('partial_backup', 'Partial Backup'), ('configuration_backup', 'Configuration Backup'), ('data_export', 'Data Export'), ('snapshot', 'System Snapshot'), ('migration_prep', 'Migration Preparation')], max_length=50)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('description', models.TextField(blank=True, help_text='Description of the preservation operation')),
                ('backup_location', models.TextField(blank=True, help_text='Location where data is preserved')),
                ('file_size_mb', models.FloatField(default=0.0, help_text='Size of preserved data in MB')),
                ('preservation_date', models.DateTimeField(default=django.utils.timezone.now)),
                ('expires_at', models.DateTimeField(blank=True, help_text='When this preservation expires', null=True)),
                ('retention_period_days', models.IntegerField(default=30, help_text='Number of days to retain the preservation')),
                ('modules_included', models.JSONField(blank=True, default=list, help_text='List of modules included in preservation')),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the preservation')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='data_preservation_created', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='data_preservation_records', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Tenant Data Preservation',
                'verbose_name_plural': 'Tenant Data Preservations',
                'ordering': ['-preservation_date'],
            },
        ),
        migrations.CreateModel(
            name='TenantDataPreservationStrategy',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Name of the preservation strategy', max_length=255, unique=True)),
                ('description', models.TextField(blank=True, help_text='Description of the preservation strategy')),
                ('is_active', models.BooleanField(default=True, help_text='Whether this strategy is active')),
                ('preservation_frequency', models.CharField(choices=[('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly'), ('quarterly', 'Quarterly'), ('on_demand', 'On Demand')], default='weekly', max_length=20)),
                ('retention_period_days', models.IntegerField(default=30, help_text='Number of days to retain backups')),
                ('modules_to_preserve', models.JSONField(blank=True, default=list, help_text='List of modules to include in preservation')),
                ('storage_location', models.CharField(default='default', help_text='Storage location for preserved data', max_length=255)),
                ('compression_enabled', models.BooleanField(default=True, help_text='Whether to compress preserved data')),
                ('encryption_enabled', models.BooleanField(default=True, help_text='Whether to encrypt preserved data')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='preservation_strategies_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Tenant Data Preservation Strategy',
                'verbose_name_plural': 'Tenant Data Preservation Strategies',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='TenantDataRestoration',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('description', models.TextField(blank=True, help_text='Description of the restoration operation')),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('modules_restored', models.JSONField(blank=True, default=list, help_text='List of modules restored')),
                ('total_records', models.IntegerField(default=0, help_text='Total number of records to restore')),
                ('restored_records', models.IntegerField(default=0, help_text='Number of records successfully restored')),
                ('failed_records', models.IntegerField(default=0, help_text='Number of records that failed to restore')),
                ('error_log', models.TextField(blank=True, help_text='Log of any errors encountered during restoration')),
                ('progress_percentage', models.FloatField(default=0.0, help_text='Progress percentage of the restoration')),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the restoration')),
                ('completed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='data_restorations_completed', to=settings.AUTH_USER_MODEL)),
                ('initiated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='data_restorations_initiated', to=settings.AUTH_USER_MODEL)),
                ('preservation_record', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='restorations', to='tenants.tenantdatapreservation')),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='data_restoration_records', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Tenant Data Restoration',
                'verbose_name_plural': 'Tenant Data Restorations',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='TenantLifecycleEvent',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('event_type', models.CharField(choices=[('created', 'Tenant Created'), ('activated', 'Tenant Activated'), ('suspended', 'Tenant Suspended'), ('reactivated', 'Tenant Reactivated'), ('archived', 'Tenant Archived'), ('restored', 'Tenant Restored'), ('deleted', 'Tenant Deleted'), ('plan_changed', 'Plan Changed'), ('subscription_renewed', 'Subscription Renewed'), ('subscription_cancelled', 'Subscription Cancelled'), ('trial_extended', 'Trial Extended'), ('domain_changed', 'Domain Changed'), ('billing_info_updated', 'Billing Info Updated')], max_length=50)),
                ('old_value', models.TextField(blank=True, help_text='Previous value before change')),
                ('new_value', models.TextField(blank=True, help_text='New value after change')),
                ('reason', models.TextField(blank=True, help_text='Reason for the lifecycle event')),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('timestamp', models.DateTimeField(default=django.utils.timezone.now)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lifecycle_events', to='tenants.tenant')),
                ('triggered_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tenant_lifecycle_events', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Tenant Lifecycle Event',
                'verbose_name_plural': 'Tenant Lifecycle Events',
                'ordering': ['-timestamp'],
            },
        ),
        migrations.CreateModel(
            name='TenantLifecycleWorkflow',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Name of the workflow', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Description of the workflow')),
                ('workflow_type', models.CharField(choices=[('onboarding', 'Onboarding'), ('offboarding', 'Offboarding'), ('suspension', 'Suspension'), ('reactivation', 'Reactivation'), ('termination', 'Termination'), ('migration', 'Migration')], max_length=50)),
                ('is_active', models.BooleanField(default=True, help_text='Whether this workflow is active')),
                ('steps', models.JSONField(blank=True, default=list, help_text='Ordered list of steps in the workflow')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='lifecycle_workflows_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Tenant Lifecycle Workflow',
                'verbose_name_plural': 'Tenant Lifecycle Workflows',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='TenantLifecycleWorkflowExecution',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('current_step', models.IntegerField(default=0, help_text='Current step in the workflow')),
                ('total_steps', models.IntegerField(default=0, help_text='Total number of steps in the workflow')),
                ('progress_percentage', models.FloatField(default=0.0, help_text='Progress percentage of the workflow')),
                ('execution_log', models.TextField(blank=True, help_text='Log of workflow execution')),
                ('error_message', models.TextField(blank=True, help_text='Error message if workflow failed')),
                ('executed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='lifecycle_workflow_executions', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='lifecycle_workflow_executions', to='tenants.tenant')),
                ('workflow', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='executions', to='tenants.tenantlifecycleworkflow')),
            ],
            options={
                'verbose_name': 'Tenant Lifecycle Workflow Execution',
                'verbose_name_plural': 'Tenant Lifecycle Workflow Executions',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='TenantMigrationRecord',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('migration_type', models.CharField(choices=[('tenant_clone', 'Tenant Clone'), ('tenant_merge', 'Tenant Merge'), ('tenant_split', 'Tenant Split'), ('data_transfer', 'Data Transfer'), ('user_transfer', 'User Transfer'), ('account_transfer', 'Account Transfer'), ('lead_transfer', 'Lead Transfer'), ('opportunity_transfer', 'Opportunity Transfer')], max_length=50)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('progress_percentage', models.FloatField(default=0.0)),
                ('total_records', models.IntegerField(default=0)),
                ('processed_records', models.IntegerField(default=0)),
                ('failed_records', models.IntegerField(default=0)),
                ('error_log', models.TextField(blank=True, help_text='Log of any errors encountered during migration')),
                ('migration_notes', models.TextField(blank=True, help_text='Notes about the migration process')),
                ('completed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='completed_migrations', to=settings.AUTH_USER_MODEL)),
                ('destination_tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='migration_destinations', to='tenants.tenant')),
                ('initiated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='initiated_migrations', to=settings.AUTH_USER_MODEL)),
                ('source_tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='migration_sources', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Tenant Migration Record',
                'verbose_name_plural': 'Tenant Migration Records',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='TenantSettings',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('logo', models.ImageField(blank=True, help_text='Upload tenant logo', null=True, upload_to='tenant_logos/')),
                ('primary_color', models.CharField(default='#6f42c1', help_text='Primary brand color in hex format', max_length=7, validators=[django.core.validators.RegexValidator(message='Enter a valid hex color code', regex='^#[0-9A-Fa-f]{6}$')])),
                ('secondary_color', models.CharField(default='#007bff', help_text='Secondary brand color in hex format', max_length=7, validators=[django.core.validators.RegexValidator(message='Enter a valid hex color code', regex='^#[0-9A-Fa-f]{6}$')])),
                ('time_zone', models.CharField(choices=[('UTC', 'UTC'), ('US/Eastern', 'US/Eastern'), ('US/Central', 'US/Central'), ('US/Mountain', 'US/Mountain'), ('US/Pacific', 'US/Pacific'), ('Europe/London', 'Europe/London'), ('Europe/Paris', 'Europe/Paris'), ('Asia/Tokyo', 'Asia/Tokyo'), ('Asia/Shanghai', 'Asia/Shanghai'), ('Asia/Kolkata', 'Asia/Kolkata')], default='UTC', help_text='Default time zone for the tenant', max_length=50)),
                ('date_format', models.CharField(choices=[('%Y-%m-%d', 'YYYY-MM-DD (ISO)'), ('%m/%d/%Y', 'MM/DD/YYYY (US)'), ('%d/%m/%Y', 'DD/MM/YYYY (EU)'), ('%m-%d-%Y', 'MM-DD-YYYY (US)'), ('%d-%m-%Y', 'DD-MM-YYYY (EU)')], default='%Y-%m-%d', help_text='Default date format', max_length=20)),
                ('language_preference', models.CharField(choices=[('en', 'English'), ('es', 'Spanish'), ('fr', 'French'), ('de', 'German'), ('ja', 'Japanese'), ('zh-hans', 'Chinese (Simplified)'), ('sw', 'Swahili')], default='en', help_text='Default language for the tenant', max_length=10)),
                ('region', models.CharField(choices=[('US', 'United States'), ('GB', 'United Kingdom'), ('EU', 'European Union'), ('KE', 'Kenya'), ('JP', 'Japan'), ('CN', 'China'), ('IN', 'India')], default='US', help_text='Default region for regional settings', max_length=10)),
                ('default_currency', models.CharField(choices=[('USD', 'US Dollar'), ('EUR', 'Euro'), ('GBP', 'British Pound'), ('JPY', 'Japanese Yen'), ('CAD', 'Canadian Dollar'), ('AUD', 'Australian Dollar'), ('CHF', 'Swiss Franc'), ('CNY', 'Chinese Yuan'), ('INR', 'Indian Rupee'), ('KES', 'Kenyan Shilling')], default='USD', help_text='Default currency for financial values', max_length=3)),
                ('business_hours', models.JSONField(blank=True, default=dict, help_text='\n        Business hours configuration example:\n        {\n            "monday": {"start": "09:00", "end": "17:00"},\n            "tuesday": {"start": "09:00", "end": "17:00"},\n            ...\n            "friday": {"start": "09:00", "end": "17:00"}\n        }\n    ')),
                ('working_days', models.JSONField(blank=True, default=list, help_text="List of working days (e.g., ['monday', 'tuesday', ...])")),
                ('session_timeout_minutes', models.PositiveIntegerField(default=120, help_text='Session timeout in minutes')),
                ('max_login_attempts', models.PositiveIntegerField(default=5, help_text='Maximum number of failed login attempts before lockout')),
                ('lockout_duration_minutes', models.PositiveIntegerField(default=30, help_text='Duration of account lockout in minutes')),
                ('is_active', models.BooleanField(default=True, help_text="Whether this tenant's settings are active")),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('tenant', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='tenant_settings', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Tenant Setting',
                'verbose_name_plural': 'Tenant Settings',
                'ordering': ['tenant__name'],
            },
        ),
        migrations.CreateModel(
            name='TenantSuspensionWorkflow',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('pending_approval', 'Pending Approval'), ('approved', 'Approved'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('rejected', 'Rejected'), ('cancelled', 'Cancelled')], default='pending_approval', max_length=20)),
                ('suspension_reason', models.TextField(help_text='Reason for the suspension')),
                ('approval_notes', models.TextField(blank=True, help_text='Notes from the approver')),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('steps_completed', models.JSONField(blank=True, default=list, help_text='List of steps that have been completed')),
                ('total_steps', models.IntegerField(default=5, help_text='Total number of steps in the suspension workflow')),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='suspension_workflows_approved', to=settings.AUTH_USER_MODEL)),
                ('initiated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='suspension_workflows_initiated', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='suspension_workflows', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Tenant Suspension Workflow',
                'verbose_name_plural': 'Tenant Suspension Workflows',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='TenantTerminationWorkflow',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('status', models.CharField(choices=[('pending_approval', 'Pending Approval'), ('approved', 'Approved'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('rejected', 'Rejected'), ('cancelled', 'Cancelled')], default='pending_approval', max_length=20)),
                ('termination_reason', models.TextField(help_text='Reason for the termination')),
                ('approval_notes', models.TextField(blank=True, help_text='Notes from the approver')),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('steps_completed', models.JSONField(blank=True, default=list, help_text='List of steps that have been completed')),
                ('total_steps', models.IntegerField(default=7, help_text='Total number of steps in the termination workflow')),
                ('data_preservation_required', models.BooleanField(default=True, help_text='Whether data preservation is required')),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='termination_workflows_approved', to=settings.AUTH_USER_MODEL)),
                ('data_preservation_record', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='termination_workflows', to='tenants.tenantdatapreservation')),
                ('initiated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='termination_workflows_initiated', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='termination_workflows', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Tenant Termination Workflow',
                'verbose_name_plural': 'Tenant Termination Workflows',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='TenantDataPreservationSchedule',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('next_scheduled_run', models.DateTimeField(help_text='When the next preservation should run')),
                ('last_run', models.DateTimeField(blank=True, help_text='When the last preservation ran', null=True)),
                ('is_active', models.BooleanField(default=True, help_text='Whether this schedule is active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='preservation_schedules', to='tenants.tenant')),
                ('strategy', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='schedules', to='tenants.tenantdatapreservationstrategy')),
            ],
            options={
                'verbose_name': 'Tenant Data Preservation Schedule',
                'verbose_name_plural': 'Tenant Data Preservation Schedules',
                'ordering': ['tenant__name', 'next_scheduled_run'],
                'unique_together': {('strategy', 'tenant')},
            },
        ),
        migrations.CreateModel(
            name='TenantFeatureEntitlement',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('feature_key', models.CharField(help_text='Unique identifier for the feature', max_length=255)),
                ('feature_name', models.CharField(help_text='Display name for the feature', max_length=255)),
                ('is_enabled', models.BooleanField(default=True, help_text='Whether the feature is enabled for this tenant')),
                ('entitlement_type', models.CharField(choices=[('always_enabled', 'Always Enabled'), ('plan_based', 'Plan Based'), ('trial', 'Trial'), ('premium', 'Premium'), ('custom', 'Custom')], default='plan_based', max_length=50)),
                ('trial_start_date', models.DateTimeField(blank=True, help_text='Start date for trial period', null=True)),
                ('trial_end_date', models.DateTimeField(blank=True, help_text='End date for trial period', null=True)),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the feature entitlement')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='feature_entitlements', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Tenant Feature Entitlement',
                'verbose_name_plural': 'Tenant Feature Entitlements',
                'ordering': ['feature_name'],
                'unique_together': {('tenant', 'feature_key')},
            },
        ),
        migrations.CreateModel(
            name='TenantUsageMetric',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('metric_type', models.CharField(choices=[('users_active', 'Active Users'), ('users_total', 'Total Users'), ('storage_used_mb', 'Storage Used (MB)'), ('api_calls', 'API Calls'), ('records_created', 'Records Created'), ('records_updated', 'Records Updated'), ('records_deleted', 'Records Deleted'), ('logins', 'Login Count'), ('sessions', 'Active Sessions'), ('emails_sent', 'Emails Sent'), ('files_uploaded', 'Files Uploaded'), ('data_exported', 'Data Exported'), ('reports_generated', 'Reports Generated'), ('integrations_active', 'Active Integrations')], max_length=100)),
                ('value', models.FloatField()),
                ('unit', models.CharField(blank=True, default='', max_length=20)),
                ('timestamp', models.DateTimeField(default=django.utils.timezone.now)),
                ('period_start', models.DateTimeField()),
                ('period_end', models.DateTimeField()),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='usage_metrics', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Tenant Usage Metric',
                'verbose_name_plural': 'Tenant Usage Metrics',
                'ordering': ['-timestamp'],
                'indexes': [models.Index(fields=['tenant', 'metric_type', 'timestamp'], name='tenants_ten_tenant__8a1a99_idx')],
            },
        ),
    ]
