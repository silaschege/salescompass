{% extends 'base.html' %}
{% load static %}

{% block title %}System Maintenance{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h1>System Maintenance</h1>
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'dashboard:cockpit' %}">Home</a></li>
                    <li class="breadcrumb-item active">System Maintenance</li>
                </ol>
            </nav>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="alert alert-info" role="alert">
                <i class="fas fa-info-circle"></i> System maintenance tools allow you to manage system operations, perform backups, and schedule maintenance windows.
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-3">
            <div class="card text-white bg-primary mb-3">
                <div class="card-body">
                    <h5 class="card-title">System Uptime</h5>
                    <p class="card-text">{{ maintenance_info.system_uptime }}</p>
                </div>
            </div>
        <div class="col-md-3">
            <div class="card text-white bg-success mb-3">
                <div class="card-body">
                    <h5 class="card-title">Database Size</h5>
                    <p class="card-text">{{ maintenance_info.database_size }}</p>
                </div>
            </div>
        <div class="col-md-3">
            <div class="card text-white bg-warning mb-3">
                <div class="card-body">
                    <h5 class="card-title">File Storage</h5>
                    <p class="card-text">{{ maintenance_info.file_storage_used }}</p>
                </div>
            </div>
        <div class="col-md-3">
            <div class="card text-white bg-info mb-3">
                <div class="card-body">
                    <h5 class="card-title">Last Backup</h5>
                    <p class="card-text">{{ maintenance_info.last_backup|date:"M d, Y" }}</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title">Maintenance Options</h5>
                </div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h6 class="card-title">Maintenance Mode</h6>
                                        <p class="card-text">Temporarily disable system access for maintenance</p>
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="maintenanceToggle" {% if maintenance_info.maintenance_mode %}checked{% endif %}>
                                            <label class="form-check-label" for="maintenanceToggle">
                                                {% if maintenance_info.maintenance_mode %}Maintenance Mode Active{% else %}Maintenance Mode Inactive{% endif %}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-body">
                                        <h6 class="card-title">Schedule Maintenance</h6>
                                        <p class="card-text">Schedule maintenance for a future time</p>
                                        <div class="mb-3">
                                            <label for="scheduledTime" class="form-label">Scheduled Time</label>
                                            <input type="datetime-local" class="form-control" id="scheduledTime" name="scheduled_time">
                                        </div>
                                        <button type="submit" name="action" value="schedule_maintenance" class="btn btn-warning">Schedule Maintenance</button>
                                    </div>
                                </div>
                            </div>
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <button type="submit" name="action" value="run_backup" class="btn btn-success me-md-2">
                                <i class="fas fa-database"></i> Run Backup
                            </button>
                            <button type="submit" name="action" value="clear_cache" class="btn btn-info me-md-2">
                                <i class="fas fa-broom"></i> Clear Cache
                            </button>
                            <button type="submit" name="action" value="toggle_maintenance" class="btn btn-warning">
                                <i class="fas fa-tools"></i> Toggle Maintenance Mode
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-3">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title">System Health</h5>
                </div>
                <div class="card-body">
                    <div class="progress mb-3">
                        <div class="progress-bar bg-success" role="progressbar" style="width: 95%"></div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <p><i class="fas fa-microchip text-primary"></i> <strong>CPU Usage:</strong> 45%</p>
                            <p><i class="fas fa-memory text-primary"></i> <strong>Memory Usage:</strong> 60%</p>
                        </div>
                        <div class="col-md-6">
                            <p><i class="fas fa-hdd text-primary"></i> <strong>Disk Usage:</strong> 30%</p>
                            <p><i class="fas fa-network-wired text-primary"></i> <strong>Network:</strong> Normal</p>
                        </div>
                    </div>
                    <div class="alert alert-success" role="alert">
                        <i class="fas fa-check-circle"></i> All systems operational
                    </div>
                </div>
            </div>
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title">Recent Maintenance Activities</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>Activity</th>
                                    <th>Status</th>
                                    <th>Performed By</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>May 10, 2023 02:00</td>
                                    <td>Daily Backup</td>
                                    <td><span class="badge bg-success">Success</span></td>
                                    <td>System</td>
                                </tr>
                                <tr>
                                    <td>May 9, 2023 23:30</td>
                                    <td>Cache Clear</td>
                                    <td><span class="badge bg-success">Success</span></td>
                                    <td>admin@example.com</td>
                                </tr>
                                <tr>
                                    <td>May 9, 2023 14:15</td>
                                    <td>Database Optimization</td>
                                    <td><span class="badge bg-success">Success</span></td>
                                    <td>system</td>
                                </tr>
                                <tr>
                                    <td>May 8, 2023 02:00</td>
                                    <td>Daily Backup</td>
                                    <td><span class="badge bg-success">Success</span></td>
                                    <td>System</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-3">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title">Maintenance Tasks</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fas fa-database fa-2x text-success mb-2"></i>
                                    <h6 class="card-title">Database Backup</h6>
                                    <button class="btn btn-sm btn-outline-success">Run Now</button>
                                </div>
                            </div>
                        <div class="col-md-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fas fa-file-export fa-2x text-info mb-2"></i>
                                    <h6 class="card-title">Data Export</h6>
                                    <button class="btn btn-sm btn-outline-info">Export</button>
                                </div>
                            </div>
                        <div class="col-md-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fas fa-trash-alt fa-2x text-warning mb-2"></i>
                                    <h6 class="card-title">Cleanup Logs</h6>
                                    <button class="btn btn-sm btn-outline-warning">Clean</button>
                                </div>
                            </div>
                        <div class="col-md-3">
                            <div class="card text-center">
                                <div class="card-body">
                                    <i class="fas fa-sync-alt fa-2x text-primary mb-2"></i>
                                    <h6 class="card-title">Update System</h6>
                                    <button class="btn btn-sm btn-outline-primary">Update</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
