{% extends "logged_in/base.html" %}
{% load static %}

{% block title %}Storefront | SalesCompass{% endblock %}

{% block extra_head %}
{{ block.super }}
<style>
    /* Custom styles for ecommerce */
    .img-profile {
        height: 2rem;
        width: 2rem;
    }
</style>
{% endblock %}

{% block sidebar_nav %}
<!-- Intentionally empty to hide the sidebar for the storefront -->
<style>
    .sidebar {
        display: none !important;
    }

    .main-content {
        margin-left: 0 !important;
    }

    #toggleSidebar {
        display: none !important;
    }
</style>
{% endblock %}

{% block content %}
<!-- Custom Topbar for Ecommerce -->
<nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow-sm">
    <div class="container d-flex justify-content-between align-items-center">
        <!-- Back to Control Plane Link -->
        <a class="btn btn-link text-muted me-3" href="{% url 'core:app_selection' %}">
            <i class="bi bi-arrow-left"></i> Exit Store
        </a>

        <a class="navbar-brand fw-bold text-primary" href="{% url 'ecommerce:index' %}">
            <i class="bi bi-shop me-2"></i>SalesCompass Store
        </a>

        <div class="d-flex align-items-center">
            <a href="{% url 'ecommerce:cart_view' %}"
                class="btn btn-outline-primary position-relative me-3 rounded-pill px-3">
                <i class="bi bi-cart3"></i>
                <span id="cart-count"
                    class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    {{ cart.item_count|default:0 }}
                </span>
            </a>

            <div class="dropdown">
                <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-bs-toggle="dropdown"
                    aria-expanded="false">
                    <span class="mr-2 d-none d-lg-inline small">{{ user.get_full_name }}</span>
                    {% if user.profile_picture %}
                    <img class="img-profile rounded-circle" src="{{ user.profile_picture.url }}" width="32">
                    {% else %}
                    <i class="bi bi-person-circle fs-5"></i>
                    {% endif %}
                </a>
                <ul class="dropdown-menu dropdown-menu-end">
                    <li><a class="dropdown-item" href="{% url 'core:logout' %}">Log Out</a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>

<div class="container pb-5">
    {% block ecommerce_content %}{% endblock %}
</div>
{% endblock %}