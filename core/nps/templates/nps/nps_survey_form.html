{% extends "nps/base.html" %}

{% block title %}NPS Survey - SalesCompass{% endblock %}

{% block content %}
    <div class="survey-container">
        <div class="header">
            <div class="logo">SalesCompass</div>
            <p>We value your feedback!</p>
        </div>
        
        <div class="question">
            {{ survey.question_text }}
        </div>
        
        <form method="post" action="">
            {% csrf_token %}
            <input type="hidden" name="account_id" value="{{ account.id }}">
            <input type="hidden" name="contact_email" value="{{ contact_email }}">
            <input type="hidden" name="survey_id" value="{{ survey.id }}">
            
            <div class="scale">
                {% for i in '012345678910'|make_list %}
                <div class="score {% if forloop.counter0 <= 6 %}detractor{% elif forloop.counter0 >= 9 %}promoter{% endif %}" 
                     onclick="selectScore({{ forloop.counter0 }})">
                    {{ forloop.counter0 }}
                </div>
                {% endfor %}
            </div>
            
            <input type="hidden" id="selected-score" name="score" value="0">
            
            <div id="follow-up" style="display: none; margin: 20px 0;">
                <label>{{ survey.follow_up_question }}</label><br>
                <textarea name="comment" rows="3" style="width: 100%; padding: 10px; margin-top: 5px;" 
                          placeholder="Please share your feedback..."></textarea>
            </div>
            
            <button type="submit" class="btn">Submit Feedback</button>
        </form>
    </div>
        <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
        .survey-container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 30px; }
        .logo { font-size: 24px; font-weight: bold; color: #6f42c1; }
        .question { font-size: 18px; margin-bottom: 20px; }
        .scale { display: flex; justify-content: space-between; margin: 30px 0; }
        .score { width: 40px; height: 40px; border: 2px solid #6f42c1; border-radius: 50%; 
                 display: flex; align-items: center; justify-content: center; 
                 cursor: pointer; font-weight: bold; }
        .score:hover { background-color: #6f42c1; color: white; }
        .promoter { border-color: #28a745; }
        .promoter:hover { background-color: #28a745; }
        .detractor { border-color: #dc3545; }
        .detractor:hover { background-color: #dc3545; }
        .btn { background-color: #6f42c1; color: white; padding: 12px 30px; 
               border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        .btn:hover { background-color: #5a32a3; }
    </style>
    <script>
        function selectScore(score) {
            document.getElementById('selected-score').value = score;
            document.querySelectorAll('.score').forEach(s => s.style.borderColor = '#6f42c1');
            document.querySelector(`.score:nth-child(${score + 1})`).style.borderColor = '#000';
            document.getElementById('follow-up').style.display = 'block';
        }
    </script>
 {% endblock %}