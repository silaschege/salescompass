# Generated by Django 5.2.7 on 2025-12-16 14:36

import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('global_alerts', '0001_initial'),
        ('tenants', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AlertCorrelationGroup',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Name of the correlation group', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Description of the correlation group')),
                ('correlation_rule', models.JSONField(blank=True, default=dict, help_text='Rule for determining related alerts')),
                ('status', models.CharField(choices=[('open', 'Open'), ('investigating', 'Investigating'), ('root_cause_identified', 'Root Cause Identified'), ('resolved', 'Resolved'), ('closed', 'Closed')], default='open', max_length=30)),
                ('severity', models.CharField(choices=[('info', 'Information'), ('warning', 'Warning'), ('error', 'Error'), ('critical', 'Critical')], default='warning', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('resolution_notes', models.TextField(blank=True, help_text='Notes about how the issue was resolved')),
                ('impact_assessment', models.TextField(blank=True, help_text='Assessment of the impact of these correlated alerts')),
                ('total_alerts', models.IntegerField(default=0, help_text='Total number of alerts in this group')),
                ('unique_alert_types', models.JSONField(blank=True, default=list, help_text='List of unique alert types in this group')),
                ('affected_tenants', models.ManyToManyField(blank=True, related_name='correlation_groups', to='tenants.tenant')),
                ('alerts', models.ManyToManyField(blank=True, related_name='correlation_groups', to='global_alerts.alertinstance')),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='correlation_groups_assigned', to=settings.AUTH_USER_MODEL)),
                ('root_cause_alert', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='correlation_children', to='global_alerts.alertinstance')),
            ],
            options={
                'verbose_name': 'Alert Correlation Group',
                'verbose_name_plural': 'Alert Correlation Groups',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AlertEscalationPath',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Name of the escalation path', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Description of the escalation procedure')),
                ('steps', models.JSONField(blank=True, default=list, help_text='Ordered list of escalation steps')),
                ('time_threshold_minutes', models.IntegerField(default=30, help_text='Time threshold to trigger next escalation step')),
                ('repeat_interval_minutes', models.IntegerField(default=60, help_text='Interval to repeat escalation if unresolved')),
                ('max_escalation_levels', models.IntegerField(default=3, help_text='Maximum number of escalation levels')),
                ('is_active', models.BooleanField(default=True, help_text='Whether this escalation path is active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('last_used', models.DateTimeField(blank=True, help_text='Last time this escalation path was used', null=True)),
                ('usage_count', models.IntegerField(default=0, help_text='Number of times this escalation path was used')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='escalation_paths_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Alert Escalation Path',
                'verbose_name_plural': 'Alert Escalation Paths',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='AlertRule',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Name of the alert rule', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Description of what this alert rule monitors')),
                ('is_active', models.BooleanField(default=True, help_text='Whether this alert rule is currently active')),
                ('condition_type', models.CharField(choices=[('threshold', 'Threshold'), ('anomaly', 'Anomaly Detection'), ('pattern', 'Pattern Matching'), ('time_based', 'Time Based'), ('dependency', 'Dependency Based'), ('custom', 'Custom Logic')], max_length=100)),
                ('condition_expression', models.TextField(help_text='Expression that defines when the alert should trigger')),
                ('severity', models.CharField(choices=[('info', 'Information'), ('warning', 'Warning'), ('error', 'Error'), ('critical', 'Critical')], default='warning', max_length=20)),
                ('frequency', models.CharField(choices=[('real_time', 'Real Time'), ('minute', 'Every Minute'), ('five_minutes', 'Every 5 Minutes'), ('hourly', 'Hourly'), ('daily', 'Daily'), ('weekly', 'Weekly')], default='real_time', max_length=20)),
                ('evaluation_window_minutes', models.IntegerField(default=5, help_text='Time window in minutes to evaluate the condition')),
                ('cooldown_period_minutes', models.IntegerField(default=15, help_text='Cooldown period to prevent alert spamming')),
                ('notification_channels', models.JSONField(blank=True, default=list, help_text='Channels to send notifications to')),
                ('escalation_policy', models.JSONField(blank=True, default=dict, help_text='How to escalate the alert')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('last_evaluated', models.DateTimeField(blank=True, help_text='Last time the rule was evaluated', null=True)),
                ('last_triggered', models.DateTimeField(blank=True, help_text='Last time the rule triggered an alert', null=True)),
                ('trigger_count', models.IntegerField(default=0, help_text='Number of times this rule has triggered')),
                ('suppression_rules', models.JSONField(blank=True, default=list, help_text='Rules to suppress this alert')),
                ('tags', models.JSONField(blank=True, default=list, help_text='Tags for organizing alert rules')),
                ('notes', models.TextField(blank=True, help_text='Internal notes about the alert rule')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='alert_rules_created', to=settings.AUTH_USER_MODEL)),
                ('target_tenants', models.ManyToManyField(blank=True, related_name='alert_rules_targeted', to='tenants.tenant')),
                ('target_users', models.ManyToManyField(blank=True, related_name='alert_rules_targeted', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Alert Rule',
                'verbose_name_plural': 'Alert Rules',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AlertSuppressionRule',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Name of the suppression rule', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Description of when alerts should be suppressed')),
                ('is_active', models.BooleanField(default=True, help_text='Whether this suppression rule is active')),
                ('suppression_type', models.CharField(choices=[('time_based', 'Time Based'), ('maintenance_window', 'Maintenance Window'), ('severity_based', 'Severity Based'), ('resource_based', 'Resource Based'), ('tenant_based', 'Tenant Based'), ('pattern_based', 'Pattern Based')], max_length=50)),
                ('suppression_condition', models.JSONField(blank=True, default=dict, help_text='Condition that determines when to suppress alerts')),
                ('start_time', models.DateTimeField(blank=True, help_text='Start time for time-based suppression', null=True)),
                ('end_time', models.DateTimeField(blank=True, help_text='End time for time-based suppression', null=True)),
                ('applies_to_alert_types', models.JSONField(blank=True, default=list, help_text='Alert types this suppression applies to')),
                ('applies_to_severities', models.JSONField(blank=True, default=list, help_text='Severities this suppression applies to')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('last_applied', models.DateTimeField(blank=True, help_text='Last time this rule was applied', null=True)),
                ('suppression_count', models.IntegerField(default=0, help_text='Number of times this rule has suppressed alerts')),
                ('applies_to_tenants', models.ManyToManyField(blank=True, related_name='alert_suppressions', to='tenants.tenant')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='suppression_rules_created', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Alert Suppression Rule',
                'verbose_name_plural': 'Alert Suppression Rules',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AppModule',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Name of the application module', max_length=255, unique=True)),
                ('slug', models.SlugField(help_text='URL-friendly identifier for the module', max_length=255, unique=True)),
                ('description', models.TextField(blank=True, help_text='Description of what the module does')),
                ('version', models.CharField(default='1.0.0', help_text='Version of the module', max_length=50)),
                ('is_active', models.BooleanField(default=True, help_text='Whether this module is available for provisioning')),
                ('is_core_module', models.BooleanField(default=False, help_text='Whether this is a core module required for all tenants')),
                ('requires_tenant_setup', models.BooleanField(default=True, help_text='Whether the module requires specific tenant setup')),
                ('installation_script', models.TextField(blank=True, help_text='Script to run when installing the module')),
                ('uninstallation_script', models.TextField(blank=True, help_text='Script to run when uninstalling the module')),
                ('configuration_schema', models.JSONField(blank=True, default=dict, help_text='JSON schema for module configuration')),
                ('default_configuration', models.JSONField(blank=True, default=dict, help_text='Default configuration for the module')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('icon_url', models.URLField(blank=True, help_text="URL to the module's icon")),
                ('documentation_url', models.URLField(blank=True, help_text="URL to the module's documentation")),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modules_created', to=settings.AUTH_USER_MODEL)),
                ('dependencies', models.ManyToManyField(blank=True, help_text='Modules that this module depends on', related_name='dependent_modules', to='infrastructure.appmodule')),
            ],
            options={
                'verbose_name': 'Application Module',
                'verbose_name_plural': 'Application Modules',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='CapacityPlanning',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('resource_type', models.CharField(choices=[('cpu', 'CPU Cores'), ('memory', 'Memory (GB)'), ('storage', 'Storage (GB)'), ('bandwidth', 'Bandwidth (Mbps)'), ('database_connections', 'Database Connections'), ('api_rate_limit', 'API Rate Limit'), ('users', 'Users'), ('requests', 'Requests per Second'), ('transactions', 'Transactions per Day')], max_length=100)),
                ('current_usage', models.FloatField(help_text='Current usage of the resource')),
                ('current_capacity', models.FloatField(help_text='Current capacity of the resource')),
                ('projected_growth_rate', models.FloatField(default=0.0, help_text='Projected growth rate (percentage)')),
                ('projected_growth_unit', models.CharField(choices=[('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly'), ('quarterly', 'Quarterly'), ('yearly', 'Yearly')], default='monthly', max_length=20)),
                ('forecast_period_months', models.IntegerField(default=12, help_text='Forecast period in months')),
                ('projected_usage', models.FloatField(blank=True, help_text='Projected usage after forecast period', null=True)),
                ('capacity_needed', models.FloatField(blank=True, help_text='Additional capacity needed', null=True)),
                ('recommendation', models.TextField(help_text='Recommendation for capacity planning')),
                ('service_name', models.CharField(help_text='Service or component being analyzed', max_length=255)),
                ('environment', models.CharField(choices=[('development', 'Development'), ('staging', 'Staging'), ('production', 'Production')], default='production', max_length=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('implementation_status', models.CharField(choices=[('not_started', 'Not Started'), ('planned', 'Planned'), ('in_progress', 'In Progress'), ('completed', 'Completed'), ('cancelled', 'Cancelled')], default='not_started', max_length=20)),
                ('implementation_date', models.DateTimeField(blank=True, null=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='capacity_planning_created', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='capacity_planning', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Capacity Planning',
                'verbose_name_plural': 'Capacity Planning',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='InfrastructureAlert',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('alert_type', models.CharField(choices=[('cpu_high', 'High CPU Usage'), ('memory_high', 'High Memory Usage'), ('disk_full', 'Disk Full'), ('network_down', 'Network Down'), ('service_down', 'Service Down'), ('database_slow', 'Slow Database'), ('connection_failed', 'Connection Failed'), ('timeout', 'Timeout'), ('error_rate', 'High Error Rate'), ('latency', 'High Latency'), ('capacity_threshold', 'Capacity Threshold Reached'), ('security_breach', 'Security Breach'), ('backup_failure', 'Backup Failure'), ('replication_error', 'Replication Error'), ('certificate_expiry', 'Certificate Expiry')], max_length=100)),
                ('severity', models.CharField(choices=[('info', 'Information'), ('warning', 'Warning'), ('error', 'Error'), ('critical', 'Critical')], default='warning', max_length=20)),
                ('title', models.CharField(max_length=255)),
                ('description', models.TextField()),
                ('affected_service', models.CharField(help_text='Service or component affected', max_length=255)),
                ('status', models.CharField(choices=[('open', 'Open'), ('acknowledged', 'Acknowledged'), ('investigating', 'Investigating'), ('resolved', 'Resolved'), ('closed', 'Closed')], default='open', max_length=20)),
                ('priority', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('urgent', 'Urgent')], default='medium', max_length=20)),
                ('trigger_timestamp', models.DateTimeField(default=django.utils.timezone.now)),
                ('resolved_timestamp', models.DateTimeField(blank=True, null=True)),
                ('acknowledged_timestamp', models.DateTimeField(blank=True, null=True)),
                ('resolution_notes', models.TextField(blank=True)),
                ('escalation_level', models.IntegerField(default=1)),
                ('auto_resolve_after_minutes', models.IntegerField(blank=True, help_text='Auto-resolve after X minutes if condition clears', null=True)),
                ('acknowledged_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='infrastructure_alerts_acknowledged', to=settings.AUTH_USER_MODEL)),
                ('affected_tenant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='infrastructure_alerts', to='tenants.tenant')),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='infrastructure_alerts_assigned', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Infrastructure Alert',
                'verbose_name_plural': 'Infrastructure Alerts',
                'ordering': ['-trigger_timestamp'],
            },
        ),
        migrations.CreateModel(
            name='InfrastructureAudit',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('change_type', models.CharField(choices=[('deployment', 'Deployment'), ('configuration_change', 'Configuration Change'), ('scaling', 'Scaling'), ('maintenance', 'Maintenance'), ('upgrade', 'Upgrade'), ('rollback', 'Rollback'), ('patch', 'Patch'), ('backup', 'Backup'), ('restore', 'Restore'), ('migration', 'Migration'), ('security_scan', 'Security Scan'), ('monitoring_change', 'Monitoring Change'), ('alert_change', 'Alert Configuration Change')], max_length=100)),
                ('service_name', models.CharField(help_text='Service or component affected', max_length=255)),
                ('environment', models.CharField(choices=[('development', 'Development'), ('staging', 'Staging'), ('production', 'Production')], default='production', max_length=50)),
                ('change_summary', models.TextField(help_text='Brief summary of the change')),
                ('change_details', models.JSONField(blank=True, default=dict, help_text='Detailed information about the change')),
                ('approval_timestamp', models.DateTimeField(blank=True, null=True)),
                ('change_timestamp', models.DateTimeField(default=django.utils.timezone.now)),
                ('rollback_possible', models.BooleanField(default=True, help_text='Whether the change can be rolled back')),
                ('rollback_instructions', models.TextField(blank=True, help_text='Instructions for rolling back the change')),
                ('impact_assessment', models.TextField(blank=True, help_text="Assessment of the change's impact")),
                ('risk_level', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], default='medium', max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('approved', 'Approved'), ('executed', 'Executed'), ('rolled_back', 'Rolled Back'), ('failed', 'Failed')], default='pending', max_length=20)),
                ('completion_timestamp', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='infrastructure_changes_approved', to=settings.AUTH_USER_MODEL)),
                ('initiated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='infrastructure_changes_initiated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Infrastructure Audit',
                'verbose_name_plural': 'Infrastructure Audits',
                'ordering': ['-change_timestamp'],
            },
        ),
        migrations.CreateModel(
            name='ModuleProvisionWorkflow',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Name of the provisioning workflow', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Description of the workflow')),
                ('workflow_type', models.CharField(choices=[('new_tenant', 'New Tenant Setup'), ('existing_tenant', 'Existing Tenant Addition'), ('upgrade', 'Module Upgrade'), ('reinstall', 'Module Reinstall'), ('custom', 'Custom Workflow')], max_length=50)),
                ('steps', models.JSONField(blank=True, default=list, help_text='Ordered list of steps in the workflow')),
                ('is_active', models.BooleanField(default=True, help_text='Whether this workflow is active')),
                ('is_default', models.BooleanField(default=False, help_text='Whether this is the default workflow for the module')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('app_module', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='provision_workflows', to='infrastructure.appmodule')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='module_provision_workflows_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='workflows_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Module Provision Workflow',
                'verbose_name_plural': 'Module Provision Workflows',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='ResourceAllocation',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('resource_type', models.CharField(choices=[('cpu', 'CPU Cores'), ('memory', 'Memory (GB)'), ('storage', 'Storage (GB)'), ('bandwidth', 'Bandwidth (Mbps)'), ('database_connections', 'Database Connections'), ('api_rate_limit', 'API Rate Limit (requests/min)'), ('worker_processes', 'Worker Processes'), ('queue_capacity', 'Queue Capacity')], max_length=100)),
                ('allocated_amount', models.FloatField(help_text='Amount of resource allocated')),
                ('available_amount', models.FloatField(help_text='Amount of resource currently available')),
                ('maximum_amount', models.FloatField(help_text='Maximum amount of resource available')),
                ('allocated_to_service', models.CharField(help_text='Service or component the resource is allocated to', max_length=255)),
                ('allocation_date', models.DateTimeField(default=django.utils.timezone.now)),
                ('expiration_date', models.DateTimeField(blank=True, help_text='When this allocation expires', null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the resource allocation')),
                ('allocated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resources_allocated', to=settings.AUTH_USER_MODEL)),
                ('allocated_to_tenant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='resource_allocations', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Resource Allocation',
                'verbose_name_plural': 'Resource Allocations',
                'ordering': ['-allocation_date'],
            },
        ),
        migrations.CreateModel(
            name='ResourceMonitoring',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('resource_type', models.CharField(choices=[('cpu', 'CPU'), ('memory', 'Memory'), ('storage', 'Storage'), ('database', 'Database'), ('network', 'Network'), ('queue', 'Queue'), ('cache', 'Cache'), ('disk_io', 'Disk I/O'), ('connections', 'Connections')], max_length=100)),
                ('service_name', models.CharField(help_text='Service or component being monitored', max_length=255)),
                ('current_value', models.FloatField(help_text='Current value of the resource metric')),
                ('unit', models.CharField(help_text='Unit of measurement (e.g., %, GB, MB/s)', max_length=20)),
                ('threshold_critical', models.FloatField(help_text='Critical threshold value')),
                ('threshold_warning', models.FloatField(help_text='Warning threshold value')),
                ('is_alerting', models.BooleanField(default=False, help_text='Whether an alert is currently active')),
                ('alert_severity', models.CharField(blank=True, choices=[('warning', 'Warning'), ('error', 'Error'), ('critical', 'Critical')], max_length=20, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True)),
                ('peak_value', models.FloatField(blank=True, help_text='Peak value recorded in the period', null=True)),
                ('avg_value', models.FloatField(blank=True, help_text='Average value in the period', null=True)),
                ('min_value', models.FloatField(blank=True, help_text='Minimum value in the period', null=True)),
                ('data_points_count', models.IntegerField(default=0, help_text='Number of data points collected in the period')),
                ('status', models.CharField(choices=[('normal', 'Normal'), ('warning', 'Warning'), ('critical', 'Critical')], default='normal', max_length=20)),
                ('tenant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='resource_monitoring', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Resource Monitoring',
                'verbose_name_plural': 'Resource Monitoring',
                'ordering': ['-last_updated'],
            },
        ),
        migrations.CreateModel(
            name='ResourceAlert',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('alert_type', models.CharField(choices=[('threshold_exceeded', 'Threshold Exceeded'), ('quota_exceeded', 'Quota Exceeded'), ('resource_low', 'Resource Low'), ('peak_usage', 'Peak Usage'), ('anomaly_detected', 'Anomaly Detected')], max_length=100)),
                ('severity', models.CharField(choices=[('info', 'Information'), ('warning', 'Warning'), ('error', 'Error'), ('critical', 'Critical')], max_length=20)),
                ('message', models.TextField(help_text='Alert message')),
                ('threshold_value', models.FloatField(help_text='Value that triggered the alert')),
                ('current_value', models.FloatField(help_text='Current value at time of alert')),
                ('status', models.CharField(choices=[('open', 'Open'), ('acknowledged', 'Acknowledged'), ('resolved', 'Resolved'), ('closed', 'Closed')], default='open', max_length=20)),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('escalation_level', models.IntegerField(default=1)),
                ('escalation_reason', models.TextField(blank=True, help_text='Reason for escalating the alert')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('acknowledged_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resource_alerts_acknowledged', to=settings.AUTH_USER_MODEL)),
                ('resolved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resource_alerts_resolved', to=settings.AUTH_USER_MODEL)),
                ('resource_monitoring', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alerts', to='infrastructure.resourcemonitoring')),
            ],
            options={
                'verbose_name': 'Resource Alert',
                'verbose_name_plural': 'Resource Alerts',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ResourceQuota',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('resource_type', models.CharField(choices=[('cpu', 'CPU Cores'), ('memory', 'Memory (GB)'), ('storage', 'Storage (GB)'), ('bandwidth', 'Bandwidth (Mbps)'), ('database_connections', 'Database Connections'), ('api_calls', 'API Calls per Month'), ('users', 'Users'), ('accounts', 'Accounts'), ('leads', 'Leads'), ('opportunities', 'Opportunities')], max_length=100)),
                ('allocated_quota', models.FloatField(help_text='Total quota allocated to the tenant')),
                ('used_quota', models.FloatField(default=0, help_text='Amount of quota currently used')),
                ('unit', models.CharField(default='units', help_text='Unit of measurement', max_length=20)),
                ('reset_cycle', models.CharField(choices=[('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly'), ('yearly', 'Yearly')], default='monthly', max_length=20)),
                ('last_reset', models.DateTimeField(auto_now_add=True)),
                ('is_soft_limit', models.BooleanField(default=False, help_text='Whether to warn instead of block when limit reached')),
                ('grace_period_hours', models.IntegerField(default=0, help_text='Grace period in hours after quota exceeded')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='resource_quotas', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Resource Quota',
                'verbose_name_plural': 'Resource Quotas',
                'ordering': ['tenant__name', 'resource_type'],
            },
        ),
        migrations.CreateModel(
            name='ResourceUsageReport',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('report_type', models.CharField(choices=[('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly'), ('quarterly', 'Quarterly'), ('yearly', 'Yearly'), ('custom', 'Custom')], max_length=100)),
                ('title', models.CharField(help_text='Report title', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Report description')),
                ('generated_at', models.DateTimeField(auto_now_add=True)),
                ('start_date', models.DateTimeField(help_text='Start date for the report')),
                ('end_date', models.DateTimeField(help_text='End date for the report')),
                ('resource_types', models.JSONField(blank=True, default=list, help_text='List of resource types included in the report')),
                ('report_data', models.JSONField(blank=True, default=dict, help_text='Report data in JSON format')),
                ('report_file_path', models.TextField(blank=True, help_text='Path to the generated report file')),
                ('is_archived', models.BooleanField(default=False, help_text='Whether the report is archived')),
                ('archived_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the report')),
                ('generated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='resource_reports_generated', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='resource_reports', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Resource Usage Report',
                'verbose_name_plural': 'Resource Usage Reports',
                'ordering': ['-generated_at'],
            },
        ),
        migrations.CreateModel(
            name='TenantModuleProvision',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('is_enabled', models.BooleanField(default=False, help_text='Whether the module is enabled for this tenant')),
                ('configuration', models.JSONField(blank=True, default=dict, help_text='Tenant-specific configuration for the module')),
                ('installed_at', models.DateTimeField(blank=True, help_text='When the module was installed', null=True)),
                ('activated_at', models.DateTimeField(blank=True, help_text='When the module was activated', null=True)),
                ('deactivated_at', models.DateTimeField(blank=True, help_text='When the module was deactivated', null=True)),
                ('uninstalled_at', models.DateTimeField(blank=True, help_text='When the module was uninstalled', null=True)),
                ('version_installed', models.CharField(help_text='Version of the module installed', max_length=50)),
                ('requires_restart', models.BooleanField(default=False, help_text='Whether activating this module requires system restart')),
                ('installation_status', models.CharField(choices=[('not_installed', 'Not Installed'), ('installing', 'Installing'), ('installed', 'Installed'), ('activating', 'Activating'), ('active', 'Active'), ('deactivating', 'Deactivating'), ('deactivated', 'Deactivated'), ('uninstalling', 'Uninstalling'), ('uninstalled', 'Uninstalled'), ('failed', 'Failed')], default='not_installed', max_length=20)),
                ('installation_error', models.TextField(blank=True, help_text='Error message if installation failed')),
                ('last_health_check', models.DateTimeField(blank=True, help_text='Last time module health was checked', null=True)),
                ('health_status', models.CharField(choices=[('healthy', 'Healthy'), ('warning', 'Warning'), ('error', 'Error'), ('critical', 'Critical')], default='healthy', max_length=20)),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the module provisioning')),
                ('activated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modules_activated', to=settings.AUTH_USER_MODEL)),
                ('app_module', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='tenant_provisions', to='infrastructure.appmodule')),
                ('deactivated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modules_deactivated', to=settings.AUTH_USER_MODEL)),
                ('installed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modules_installed', to=settings.AUTH_USER_MODEL)),
                ('tenant', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='module_provisions', to='tenants.tenant')),
                ('uninstalled_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='modules_uninstalled', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Tenant Module Provision',
                'verbose_name_plural': 'Tenant Module Provisions',
                'ordering': ['tenant__name', 'app_module__name'],
            },
        ),
        migrations.CreateModel(
            name='AlertNotificationPreference',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('alert_type', models.CharField(choices=[('system', 'System Alerts'), ('security', 'Security Alerts'), ('performance', 'Performance Alerts'), ('availability', 'Availability Alerts'), ('capacity', 'Capacity Alerts'), ('maintenance', 'Maintenance Alerts'), ('custom', 'Custom Alerts')], max_length=100)),
                ('channel', models.CharField(choices=[('email', 'Email'), ('sms', 'SMS'), ('push', 'Push Notification'), ('webhook', 'Webhook'), ('slack', 'Slack'), ('microsoft_teams', 'Microsoft Teams'), ('pagerduty', 'PagerDuty'), ('discord', 'Discord')], max_length=50)),
                ('priority', models.CharField(choices=[('low', 'Low'), ('normal', 'Normal'), ('high', 'High'), ('urgent', 'Urgent')], default='normal', max_length=20)),
                ('is_enabled', models.BooleanField(default=True, help_text='Whether notifications are enabled for this channel')),
                ('custom_recipients', models.JSONField(blank=True, default=list, help_text='Additional recipients for this alert type')),
                ('notification_template', models.TextField(blank=True, help_text='Custom template for notifications')),
                ('timezone', models.CharField(default='UTC', help_text='Timezone for scheduling notifications', max_length=50)),
                ('daily_digest', models.BooleanField(default=False, help_text='Whether to receive daily digest instead of individual alerts')),
                ('weekly_summary', models.BooleanField(default=False, help_text='Whether to receive weekly summary')),
                ('notification_schedule', models.JSONField(blank=True, default=dict, help_text='Schedule for when notifications are allowed')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alert_notification_preferences', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Alert Notification Preference',
                'verbose_name_plural': 'Alert Notification Preferences',
                'ordering': ['user__email', 'alert_type'],
                'unique_together': {('user', 'alert_type', 'channel')},
            },
        ),
        migrations.CreateModel(
            name='ModuleDependency',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('dependency_type', models.CharField(choices=[('requires', 'Requires'), ('conflicts_with', 'Conflicts With'), ('optional', 'Optional'), ('recommended', 'Recommended')], max_length=50)),
                ('min_version', models.CharField(blank=True, help_text='Minimum required version', max_length=50)),
                ('max_version', models.CharField(blank=True, help_text='Maximum allowed version', max_length=50)),
                ('is_active', models.BooleanField(default=True, help_text='Whether this dependency is active')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('notes', models.TextField(blank=True, help_text='Additional notes about the dependency')),
                ('dependent_module', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='module_dependencies', to='infrastructure.appmodule')),
                ('required_module', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='required_by_modules', to='infrastructure.appmodule')),
            ],
            options={
                'verbose_name': 'Module Dependency',
                'verbose_name_plural': 'Module Dependencies',
                'ordering': ['dependent_module__name', 'required_module__name'],
                'unique_together': {('dependent_module', 'required_module')},
            },
        ),
        migrations.CreateModel(
            name='PerformanceBaseline',
            fields=[
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('baseline_type', models.CharField(choices=[('response_time', 'API Response Time'), ('throughput', 'Request Throughput'), ('concurrency', 'Concurrent Users'), ('memory_usage', 'Memory Usage'), ('cpu_usage', 'CPU Usage'), ('database_queries', 'Database Query Time'), ('cache_hit_ratio', 'Cache Hit Ratio'), ('disk_io', 'Disk I/O')], max_length=100)),
                ('baseline_value', models.FloatField(help_text='Expected performance value')),
                ('unit', models.CharField(default='ms', max_length=20)),
                ('service_name', models.CharField(help_text='Service or component being benchmarked', max_length=255)),
                ('environment', models.CharField(choices=[('development', 'Development'), ('staging', 'Staging'), ('production', 'Production')], default='production', max_length=50)),
                ('baseline_period', models.CharField(choices=[('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly'), ('quarterly', 'Quarterly'), ('yearly', 'Yearly')], default='monthly', max_length=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('tenant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='performance_baselines', to='tenants.tenant')),
            ],
            options={
                'verbose_name': 'Performance Baseline',
                'verbose_name_plural': 'Performance Baselines',
                'ordering': ['baseline_type', 'service_name'],
                'unique_together': {('baseline_type', 'service_name', 'environment', 'tenant', 'baseline_period')},
            },
        ),
        migrations.AddIndex(
            model_name='resourcemonitoring',
            index=models.Index(fields=['resource_type', 'service_name', 'tenant', '-last_updated'], name='infrastruct_resourc_80fd3f_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='resourcequota',
            unique_together={('tenant', 'resource_type')},
        ),
        migrations.AlterUniqueTogether(
            name='tenantmoduleprovision',
            unique_together={('tenant', 'app_module')},
        ),
    ]
